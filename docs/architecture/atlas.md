# HMS-A2A Relationship Atlas

This document synthesizes dependency information across the Python, Rust, and Lean components targeted for migration or integration.

Plan Ref: HMS-A2A MIGRATION MASTER PLAN (v 2.1), Section 1.3

## A. Data-type Flow

*(Placeholder: Describe major data structures (Protobuf messages like `ProofBundle`, `EconomicDeal`, `GraphPlan`; key JSON formats) and how they flow between subsystems. Consider adding sequence diagrams for key interactions if helpful.)*


## B. Control-flow between Subsystems

### Combined Import-Dependency Graph (Python/Lean/Rust - Approximate)

*(This graph shows potential dependencies based on imports found by the inventory script. Linkages are approximate.)*

![Inventory dependency graph](generated_inventory/inventory_dependencies.svg)

### Rust Workspace Crate Graph

*(This graph shows dependencies between crates within the `core` Cargo workspace, generated by `cargo-depgraph`.)*

![Rust crate graph](generated_inventory/rust_workspace.svg)

### Lean Project Dependencies

*(Dependencies identified from `lake build` output. List key libraries like `Mathlib`, `Std`, etc.)*

```txt
<PASTE RELEVANT LINES FROM lean_build_log.txt HERE>
```


## C. FFI Crossings

*(Placeholder: Detail the planned Foreign Function Interface boundaries.)*

| Boundary           | Technology      | Purpose                                     | Status      |
|--------------------|-----------------|---------------------------------------------|-------------|
| Rust ⇄ Python      | PyO3 + Maturin  | Expose Rust core logic (trade, mac, graph)  | Planned     |
|                    |                 | Call Python GTP from Rust genetic engine    | Planned     |
| Rust ⇄ Lean (JSON) | build.rs + serde | Ingest formal theorems into `econ_formal` | Planned     |
| Rust ⇄ C (Future?) | cbindgen        | Potential for external system integration   | Speculative |


## D. External Persistence / Services

*(Placeholder: List interactions with databases, file systems, external APIs, etc.)*

*   **Database:** PostgreSQL (via `sqlx` in `crates/data_store`) - Stores agent state, deal history? (Verify scope)
*   **File System:** Configuration files (`core/config`), potentially logs, theorem JSON exports (`core/lean4_economic_foundations`).
*   **Network Services:** gRPC communication between agents/supervisor (`crates/communication`). Potential external API calls by agents?


## Appendix: Module Classification

See `generated_inventory/inventory.xlsx` for a heuristic classification of scanned modules into:
*   **Pure:** Primarily algorithmic, stateless computations.
*   **IO:** Interacts with filesystem, network, console.
*   **Service:** Represents long-running processes, agents, orchestrators. 